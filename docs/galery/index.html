<!DOCTYPE html>
<html lang="ru">

<head>
  <link rel="icon" type="image/png" href="../assets/favicon.png">
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Галерея — SSquadra</title>
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Manrope:wght@300;400;600;700&display=swap" rel="stylesheet">
  <link rel="stylesheet" href="../style.css" />
  <style>
    /* === Основной контейнер галереи === */
    .masonry-gallery {
      column-count: 1;
      column-gap: 16px;
      padding: 0 16px 30px;
    }

    @media (min-width: 600px) {
      .masonry-gallery {
        column-count: 2;
      }
    }

    @media (min-width: 900px) {
      .masonry-gallery {
        column-count: 3;
      }
    }

    @media (min-width: 1200px) {
      .masonry-gallery {
        column-count: 4;
      }
    }

    /* === Элемент галереи === */
    .masonry-item {
      break-inside: avoid;
      margin-bottom: 16px;
    }

    .masonry-item img {
      width: 100%;
      height: auto;
      display: block;
      border-radius: 12px;
      box-shadow: 0 6px 16px rgba(0, 0, 0, 0.25);
    }
  </style>
</head>

<body>
  <div id="particles"></div>

  <header>
    <button class="hamburger" aria-label="Меню">☰</button>
    <h1>Галерея</h1>
  </header>

  <nav class="sidebar" id="sidebar">
    <ul>
      <li><a href="/SSwiki/">Главная</a></li>
      <li><a href="#">2</a></li>
      <li><a href="#">3</a></li>
      <li><a href="#">4</a></li>
    </ul>
  </nav>

  <!-- Описание -->
  <div class="glass-block">
    <p>Здесь будут крути фотокаточки</p>
  </div>

  <!-- Галерея -->
  <div class="masonry-gallery" id="gallery"></div>

  <div class="bottom-glass-fade"></div>

  <script src="../script.js"></script>
  <script>
    // === Загрузка изображений ===
    const gallery = document.getElementById('gallery');
    const maxImages = 50;

    for (let i = 1; i <= maxImages; i++) {
      const item = document.createElement('div');
      item.className = 'masonry-item';

      const wrapper = document.createElement('div');
      wrapper.className = 'image-wrapper';

      const img = document.createElement('img');
      img.src = `${i}.png`;
      img.alt = `Изображение ${i}`;
      img.loading = 'lazy';

      const lightEffect = document.createElement('div');
      lightEffect.className = 'light-effect';

      const darkenEffect = document.createElement('div');
      darkenEffect.className = 'darken-effect';

      wrapper.appendChild(img);
      wrapper.appendChild(lightEffect);
      wrapper.appendChild(darkenEffect);
      item.appendChild(wrapper);
      gallery.appendChild(item);

      img.onerror = () => item.remove();
    }

    // === ЭФФЕКТ НАВЕДЕНИЯ ===
    let ticking = false;

    document.querySelectorAll('.image-wrapper').forEach(wrapper => {
      const img = wrapper.querySelector('img');
      const lightEffect = wrapper.querySelector('.light-effect');
      const darkenEffect = wrapper.querySelector('.darken-effect');
      let isHovered = false;

      // Устанавливаем начальные стили для wrapper
      wrapper.style.position = 'relative';
      wrapper.style.transformStyle = 'preserve-3d';
      wrapper.style.perspective = '1000px';
      wrapper.style.transition = 'transform 0.2s ease';
      wrapper.style.borderRadius = '12px';
      wrapper.style.overflow = 'hidden';
      wrapper.style.boxShadow = '0 6px 16px rgba(0, 0, 0, 0.25)';

      lightEffect.style.cssText = `
      position: absolute;
      top: 0; left: 0; width: 100%; height: 100%;
      background: radial-gradient(circle at var(--x) var(--y), rgba(255,255,255,0.5), transparent 70%);
      opacity: 0;
      pointer-events: none;
      transition: opacity 0.1s ease;
    `;

      darkenEffect.style.cssText = `
      position: absolute;
      top: 0; left: 0; width: 100%; height: 100%;
      background: rgba(0,0,0,0.5);
      opacity: 0;
      pointer-events: none;
      transition: opacity 0.1s ease;
    `;

      wrapper.addEventListener('mouseenter', () => {
        isHovered = true;
        wrapper.style.transition = 'transform 0.1s ease';
        wrapper.style.transform = 'perspective(1000px) rotateX(0deg) rotateY(0deg) translateZ(20px) scale(1.03)';
      });

      wrapper.addEventListener('mousemove', (e) => {
        if (!isHovered) return;
        if (!ticking) {
          window.requestAnimationFrame(() => {
            const rect = wrapper.getBoundingClientRect();
            const x = e.clientX - rect.left;
            const y = e.clientY - rect.top;

            lightEffect.style.setProperty('--x', `${x}px`);
            lightEffect.style.setProperty('--y', `${y}px`);

            const centerX = rect.width / 2;
            const centerY = rect.height / 2;
            const rotateX = -(y - centerY) / 12;
            const rotateY = -(centerX - x) / 12;

            wrapper.style.transform = `perspective(1000px) rotateX(${rotateX}deg) rotateY(${rotateY}deg) translateZ(20px) scale(1.03)`;

            if (rotateX > 0) {
              lightEffect.style.opacity = Math.min(rotateX / 30, 0.4);
              darkenEffect.style.opacity = 0;
            } else {
              darkenEffect.style.opacity = Math.min(Math.abs(rotateX) / 30, 0.3);
              lightEffect.style.opacity = 0;
            }
            ticking = false;
          });
          ticking = true;
        }
      });

      wrapper.addEventListener('mouseleave', () => {
        isHovered = false;
        wrapper.style.transition = 'transform 0.2s ease';
        wrapper.style.transform = 'perspective(1000px) rotateX(0deg) rotateY(0deg) translateZ(0) scale(1)';
        lightEffect.style.opacity = 0;
        darkenEffect.style.opacity = 0;
      });
    });
  </script>
</body>

</html>
